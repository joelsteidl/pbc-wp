!function(t,e,i){"function"==typeof define&&define.amd?define("begrid",e):"object"==typeof module&&module.exports?module.exports=e(i):t.BeGrid=e(i)}(window,function(t){"use strict";var e=t(window),i=function(i){null==i||t(i).hasClass("be-grid-initialized")||(this.init(i),e.load(function(){this.ele.isotope("layout")}.bind(this)))};return i.prototype.init=function(e){null!=e&&(this.ele=t(e),this.setDefaultProps(),this.setLayout(),this.setGutter(),this.initGridAnimation(),this.grid(),this.initEvents(),this.filterItems())},i.prototype.initEvents=function(){e.on("load",function(){this.ele.isotope("layout")}.bind(this)),e.on("debouncedresize",function(){var e=this.ele.find("audio, video"),i=this.ele.find(".be-slider");this.grid(),0<e.length&&e.each(function(){var e=t(this).data().mediaelementplayer;"object"==typeof e&&(e.setPlayerSize(),e.setControlsSize())}),0<i.length&&(i.each(function(){var e=t(this);e.hasClass("flickity-enabled")&&e.flickity("reposition")}),this.ele.isotope("layout"))}.bind(this))},i.prototype.setDefaultProps=function(){this.cols=3,this.gutter=0,this.elementsToReveal=null,this.animationType="revealAllAtOnce",this.layout="masonry"},i.prototype.setGutter=function(){this.gutter=parseInt(this.ele.attr("data-gutter"))||0},i.prototype.setLayout=function(){"metro"===this.ele.attr("data-layout")&&(this.layout="metro")},i.prototype.setCols=function(){var t=parseInt(this.ele.attr("data-cols"))||3,i=e.width();if(1366<i)this.cols=t;else if(959<i)switch(t){case 1:this.cols=1;break;case 2:this.cols=2;break;case 3:default:this.cols=3}else this.cols=767<i?1==t?1:2:1},i.prototype.initGridAnimation=function(){this.animationType="1"===this.ele.attr("data-scroll-reveal")?"scrollReveal":"revealAllAtOnce",this.elementsToReveal=this.ele.find(".be-col"),this.addAnimationClass(),"scrollReveal"===this.animationType&&e.on("scroll",function(){this.triggerScrollReveal()}.bind(this))},i.prototype.addAnimationClass=function(){var t=this.ele.attr("data-animation-target")||".be-col",e=this.ele.attr("data-animation")||"be-col-hide";this.ele.find(t).addClass(e)},i.prototype.triggerScrollReveal=function(){if("scrollReveal"===this.animationType&&0<this.elementsToReveal.length){var e=this.elementsToReveal.filter(function(){return t(this).isVisible(-100)});0<e.length&&(e.each(function(e,i){var s=t(i),a=null==this.ele.attr("data-animation")?"be-col-visible":"be-start-animation",n=this.ele.attr("data-animation-target");null!=n&&(s=s.find(n)),s.css("transition-delay",150*e+"ms"),s.addClass(a)}.bind(this)),this.elementsToReveal=this.elementsToReveal.not(e))}},i.prototype.filterItems=function(){"1"===this.ele.attr("data-filter-items")&&this.ele.parent().on("click",".sort-items",function(e){var i=t(e.currentTarget).data("id"),s=t([]);if(!t(e.currentTarget).hasClass("current_choice")){this.ele.parent().find(".sort-items").removeClass("current_choice"),t(e.currentTarget).addClass("current_choice");var a=this.ele.find(".be-col");a.css({transform:"scale(0)",transition:"all 0.3s ease"}),setTimeout(function(){a.find(".be-start-animation").css("transition-delay",""),a.css({transform:"",transition:""}),this.ele.isotope({filter:function(){var e=t(this).data("category-names");if("all"===i||e.indexOf(i)>-1)return s=s.add(t(this)),!0},transitionDuration:0}),s.find(".be-start-animation").removeClass("be-start-animation"),this.elementsToReveal=s,setTimeout(function(){"scrollReveal"===this.animationType?this.triggerScrollReveal():this.revealAllAtOnce()}.bind(this),0)}.bind(this),300)}}.bind(this))},i.prototype.revealAllAtOnce=function(){"revealAllAtOnce"===this.animationType&&0<this.elementsToReveal.length&&(this.elementsToReveal.each(function(e,i){var s=t(i),a=null==this.ele.attr("data-animation")?"be-col-visible":"be-start-animation",n=this.ele.attr("data-animation-target");null!=n&&(s=s.find(n)),s.css("transition-delay",150*e+"ms"),s.addClass(a)}.bind(this)),this.elementsToReveal=t([]))},i.prototype.grid=function(){this.setCols(),this.setWidth(),this.setGiantCells(),this.renderLayout()},i.prototype.setWidth=function(){this.ele.width("");for(var i,s,a=this.ele.width(),n=e.width(),l=this.ele.find(".be-col");a%this.cols!=0;)a+=1;this.ele.width(a),s=a/this.cols,"masonry"==this.layout?l.outerWidth(s):(767<n&&0<(i=l.filter(function(){return t(this).hasClass("be-double-width-cell")||t(this).hasClass("be-double-width-height-cell")})).length&&(l=l.not(i),i.outerWidth(2*s)),l.outerWidth(s))},i.prototype.setGiantCells=function(){if("metro"==this.layout){var i=isNaN(parseFloat(this.ele.attr("data-aspect-ratio")))?1:parseFloat(this.ele.attr("data-aspect-ratio")),s=this.ele.width()/this.cols-this.gutter,a=e.width(),n=s/i,l=(n=Math.round(100*n)/100,this.ele.find(".be-double-width-cell")),o=this.ele.find(".be-double-height-cell"),r=this.ele.find(".be-double-width-height-cell");0<l.length&&l.each(function(e,i){var l,o=t(i);l=767<a?n/(2*s+this.gutter):n/s,isNaN(l)||(l*=100,o.find(".be-grid-placeholder").css("padding-bottom",l+"%"))}.bind(this)),0<o.length&&o.each(function(e,i){var a=t(i),l=(2*n+this.gutter)/s;isNaN(l)||(l*=100,a.find(".be-grid-placeholder").css("padding-bottom",l+"%"))}.bind(this)),0<r.length&&r.each(function(e,i){var l,o=t(i);l=767<a?(2*n+this.gutter)/(2*s+this.gutter):(2*n+this.gutter)/s,isNaN(l)||(l*=100,o.find(".be-grid-placeholder").css("padding-bottom",l+"%"))}.bind(this))}},i.prototype.renderLayout=function(){var t=this.ele.width()/this.cols;this.ele.isotope({isInitLayout:!1,itemSelector:".be-col",resize:!1,masonry:{columnWidth:t}}),this.ele.on("layoutComplete",function(){this.ele.hasClass("be-grid-initialized")||(this.ele.addClass("be-grid-initialized"),setTimeout(function(){"scrollReveal"===this.animationType?this.triggerScrollReveal():this.revealAllAtOnce(),BeLazyLoad.lazyLoad()}.bind(this),0))}.bind(this)),this.ele.isotope()},i},jQuery);